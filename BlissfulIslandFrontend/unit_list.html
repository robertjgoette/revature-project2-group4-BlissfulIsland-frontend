<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="CSS/Logo-s.png"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./CSS/style.css">
    <title>Unit List</title>
</head>

<body>
    <!--start of  navbar-->
    <header id="navBar" class="navBar">
        <div class="navBar__logo">
            <img id="logoM" class="navBar__img" src="CSS/Logo-M.png" alt="Logo">
        </div>
        <div id="navBarGroup" class="navBar__group">
            <div id="accountMaker" class="navBar__group__links"></div>
            <div id="message" class = "navBar__group__links"></div>
            <div class="navBar__group__links">
                <a id="logOut" onclick="logOut()">Log Out</a>
            </div>
        </div>
    </header>
    <!--end of nav bar-->


    <!--table type test-->
    <div>
        <div class="plusBox" id= "plusBtn1" onclick="flipPlus()">
            <h3>Type Test</h3>
            <div class="plus__btn">
                <span id="oldPlus" class="plus"></span>
            </div>
        </div>

        <div id="typeTest" class="tables inactive">
            <table id="typeTestTable" class="tables__unit_type">
                <thead>
                    <th>Unit Number</th>
                    <th>Available</th>
                </thead>
                <tbody id="requestUnitList"></tbody>
            </table>
        </div>
    </div>
    <!-- table type normal-->
    <div class="plusBox" id= "plusBtn2" onclick="flipPlusN()">
        <h3>Type Normal</h3>
        <div class="plus__btn">
            <span id="normalPlus" class="plus"></span>
        </div>
    </div>

    <div id="typeNormal" class="tables inactive">
        <table id="typeNormalTable" class="tables__unit_type">
            <thead>
                <th>Unit Number</th>
                <th>Available</th>
            </thead>
            <tbody id="requestUnitList1"></tbody>
        </table>
    </div>

    <!--table type delux-->
    <div class="plusBox" id= "plusBtn3" onclick="flipPlusD()">
        <h3>Type Delux</h3>
        <div class="plus__btn">
            <span id="deluxPlus" class="plus"></span>
        </div>
    </div>
    <div id="typeDelux" class="tables inactive">
        <table id="typeDeluxTable" class="tables__unit_type">
            <thead>
                <th>Unit Number</th>
                <th>Available</th>
            </thead>
            <tbody id="requestUnitList2"></tbody>
        </table>
    </div>

</body>
<script>
    getUnitList();
    const accountType = localStorage.getItem("accountType");
    const accountId = localStorage.getItem("accountID"); 
    const accountMaker = document.getElementById("accountMaker");
    const unitList = document.getElementById("unitList");
    const navBarGroup = document.getElementById("navBarGroup");
    const navBar = document.getElementById("navBar");
    const message = document.getElementById("message");
    const logoM = document.getElementById("logoM");


    const typeTest = document.getElementById("typeTest");
    const typeNormal = document.getElementById("typeNormal");
    const typeDelux = document.getElementById("typeDelux");
    const oldPlus = document.getElementById("oldPlus");
    const normalPlus = document.getElementById("normalPlus");
    const deluxPlus = document.getElementById("deluxPlus");

    // flip function for type test
    function flipPlus() {
        oldPlus.classList.toggle("plus--acitve")
        if (typeTest.style.maxHeight) {
            typeTest.style.maxHeight = null;
        } else {
            typeTest.style.maxHeight = typeTest.scrollHeight + "px";
        }
    }
    // flip function for type normal
    function flipPlusN() {
        normalPlus.classList.toggle("plus--acitve")
        if (typeNormal.style.maxHeight) {
            typeNormal.style.maxHeight = null;
        } else {
            typeNormal.style.maxHeight = typeNormal.scrollHeight + "px";
        }
    }
    //flip function for type delux
    function flipPlusD() {
        deluxPlus.classList.toggle("plus--acitve")
        if (typeDelux.style.maxHeight) {
            typeDelux.style.maxHeight = null;
        } else {
            typeDelux.style.maxHeight = typeDelux.scrollHeight + "px";
        }
    }
    //function to get the unit list
    async function getUnitList() {
        const response = await fetch(`http://127.0.0.1:7000/typesAvailability`);
        if (response.status === 404) {
            return alert("There is no data to retrieve");
        } else {
            const records = await response.json();
            let tableRow = "";
            for (let record of records) {
                if (record.typeId == 1) {
                    tableRow += `<tr>
               <td>${record.aptNumber}</td>
               <td>${record.available}</td>
              </tr> `
                }
            }
            requestUnitList.innerHTML = tableRow;

            let tableRow1 = ""
            for (let record of records) {
                if (record.typeId == 2) {
                    tableRow1 += `<tr>
               <td>${record.aptNumber}</td>
               <td>${record.available}</td>
              </tr> `

                }
            }
            requestUnitList1.innerHTML = tableRow1;

            let tableRow2 = ""
            for (let record of records) {
                if (record.typeId === 3) {
                    tableRow2 += `<tr>
               <td>${record.aptNumber}</td>
               <td>${record.available}</td>
              </tr> `

                }
            }
            requestUnitList2.innerHTML = tableRow2;
        }
    }
</script>
<script src="JS/index.js"></script>

</html>